import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Rencontre 1 - Accueil

:::note R√©sum√© de la s√©ance

<Tabs>

<TabItem value="deroulement" label="üë®‚Äçüè´ D√©roulement du cours">

- Accueil et introduction au cours
- Pr√©sentation du plan de cours
- Pourquoi l'automatisation est importante?
- Introduction √† l'invite de commande PowerShell
- Exercices √† faire en classe et √† compl√©ter √† la maison

</TabItem>

<TabItem value="exercices" label="üíª Exercices √† compl√©ter">

Les exercices suivants se trouvent dans votre section personnelle du bloc-notes du cours, sous l'onglet *Exercices*:
- Exercice 01a: Alias et commandes
- Exercice 01b: Commandes PowerShell

</TabItem>

<TabItem value="ressources" label="üìö Ressources √† consulter">

- La pr√©sentation PowerPoint est sur le Teams du cours, sous le canal G√©n√©ral > Fichiers > Supports de cours.

</TabItem>

</Tabs>

:::

## Introduction

### Les scripts et l'automatisation de t√¢ches

Les scripts et les outils d'automatisation sont un atout consid√©rable en administration r√©seau. Ils procurent de nombreux avantages, notamment:

- √âliminer les t√¢ches r√©p√©titives sans valeur ajout√©e
- Ex√©cuter la m√™me t√¢che sur un grand nombre de machines
- Rentabiliser le temps des √©quipes TI
- Faire des choses beaucoup plus amusantes et moins routini√®res!
- Consacrer plus de temps pour l‚Äô√©volution et l‚Äôam√©lioration continue
- R√©duire les risques d‚Äôerreurs humaines

### Qu'est-ce qu'une coque logicielle (shell)?

Le shell est l‚Äôinterface personne-machine d‚Äôun syst√®me d‚Äôexploitation. Il permet √† l‚Äôutilisateur d‚Äôexploiter les fonctionnalit√©s offertes par le syst√®me.

Sous Windows, l'interpr√©teur de commande classique (cmd.exe), l'interface graphique (explorer.exe) et PowerShell constituent les principaux shells. Sous Linux et les autres syst√®mes bas√©s sur UNIX, le plus connu est bash, mais il en existe aussi plusieurs variantes (sh, csh, ksh, zsh, etc.)

### Qu'est-ce qu'un script d'administration

Contrairement aux langages de programmation comme C++, C# ou Java, les langages de scripts ont g√©n√©ralement ces caract√©ristiques:
- Centr√©s sur une t√¢che pr√©cise
- Interpr√©t√©s (ne n√©cessitent pas de compilation)
- Ne poss√®dent pas d‚Äôinterface graphique
- Utilisent des commandes ou des librairies du syst√®me
- Mais poss√®dent tout de m√™me des structures de contr√¥le

Souvent, les scripts d'administration sont li√©s √† un shell. Ils exploitent les commandes de celui-ci d‚Äôune mani√®re programmatique.

### Principaux langages de script sous Windows

- DOS Batch (.bat, .cmd)
- PowerShell (.ps1)
- VBScript (.vbs, .wsf)
- Python (.py)
- KiXtart (.kix)
- JavaScript (.js, .wsf)


### L'invite de commande Windows

Le shell textuel principal de Windows est l'invite de commande (command prompt en anglais). Son interpr√©teur est situ√© dans les fichiers syst√®me de Windows:

	C:\Windows\System32\cmd.exe

On peut le lancer par le menu D√©marrer, ou simplement en lan√ßant la commande "cmd".

![image](./assets/r01_02a.png)

La console d√©marre avec un invite qui indique le r√©pertoire de travail (le r√©pertoire dans lequel on se trouve). On peut lancer des commandes, une √† la fois. Lorsque les commandes interagissent avec le syst√®me de fichiers, elles sont relatives au chemin de travail, √† moins de sp√©cifier un chemin sp√©cifique en argument.

![image](./assets/r01_02b.png)


## Windows PowerShell

PowerShell est √† la fois un langage de script et un interpr√©teur de commandes (√† l'instar de l'interpr√©teur classique, cmd.exe).

Non seulement PowerShell permet le d√©veloppement de scripts, il est √©galement optimis√© pour la ligne de commande. Sans m√™me √©crire un fichier de script, on peut faire √† la ligne de commande ce qui aurait autrement n√©cessit√© un script dans plusieurs autres shells.

### Commandes PowerShell (cmdlets)

Dans la plupart des interpr√©teurs (cmd, bash, etc.), la tr√®s grande majorit√© des commandes qu'on emploie √† la ligne de commande ou par script sont essentiellement des ex√©cutables qui se trouvent dans un r√©pertoire sp√©cial. Lorsqu'on utilise des commandes comme Ping ou Ipconfig dans la console, cela ne fait que lancer l'ex√©cutable ping.exe ou ipconfig.exe qui se trouvent dans C:\Windows\system32\ et afficher le texte qui en r√©sulte dans la console.

![image](./assets/r01_04a.png)

Les donn√©es en format textuel sont particuli√®rement difficiles √† interpr√©ter, en supposant par exemple qu'on veuille en extraire certaines valeurs. 

PowerShell fonctionne diff√©remment. En PowerShell, une commande "native" est appel√©e "cmdlet" et retournent des objets plut√¥t que du texte. Cela procure plusieurs avantages.

![image](./assets/r01_04b.png)

Ce qui est affich√© dans la console est une conversion automatique de l'objet en texte. Mais PowerShell permet toute une panoplie de manipulations qu'on peut effectuer sur l'objet avant sa conversion. Par exemple, on peut sp√©cifier le format d'affichage de l'objet, et les propri√©t√©s √† afficher.

![image](./assets/r01_04c.png)

Ou encore, effectuer un calcul sur l'objet. Par exemple, calculer la somme des temps r√©ponse de chacune des 4 tentatives de ping.

![image](./assets/r01_04d.png)

On peut aussi extraire une valeur sp√©cifique.

![image](./assets/r01_04e.png)


### Appellation d'une commande PowerShell

L'appellation d'une commande (cmdlet) est toujours d√©finie sous la forme `Verbe-Nom`.


#### Le verbe (_verb_)

Le verbe d√©crit une action pos√©e sur un certain √©l√©ment accessible par le syst√®me d'exploitation.

| Verbe     | Description                                 |
| --------- | ------------------------------------------- |
| `Get`     | Obtenir de l'information                    |
| `Set`     | √âcrire (remplacer) des donn√©es ou attributs |
| `New`     | Cr√©er un nouvel objet                       |
| `Copy`    | Copier un objet                             |
| `Stop`    | Arr√™ter un objet                            |
| `Restart` | Red√©marrer un objet                         |


#### Le nom (_noun_)

Le nom d√©crit un objet sur lequel l'action sera pos√©e.

| Nom | Description |
| -- | -- |
| `Process` | Un ou plusieurs processus en cours d'ex√©cution |
| `Service` | Un ou plusieurs services enregistr√©s par le gestionnaire de services de Windows |
| `Command` | Une commande PowerShell enregistr√©e |
| `Location` | Le r√©pertoire courant |
| `Item` | Les √©l√©ments du provider (g√©n√©ralement, les fichiers et dossiers du syst√®me de fichiers) |
| `Computer` | L'ordinateur |
| `Help` | Les rubriques d'aide |


#### Exemples de commandes

Une commande sert √† poser une action sur quelque chose. Son nom est donc la combinaison d'un verbe et d'un nom.

| Commande | Description |
| -- | -- |
| `Get-Process` | Obtient l'information sur un ou plusieurs processus en cours d'ex√©cution |
| `Get-Item` | Obtient de l'information sur un √©l√©ment  (fichier ou dossier) |
| `Get-ChildItem` | Obtient de l'information sur un ou plusieurs √©l√©ments enfant (fichier ou dossier, √©quivalent √† la commande DIR ou LS) |
| `Copy-Item` | Copie un √©l√©ment (fichier ou dossier) |
| `Stop-Service` | Arr√™te un service en cours d'ex√©cution |
| `Start-Service` | D√©marre un service enregistr√© |
| `Restart-Service` | Red√©marre un service en cours d'ex√©cution |
| `Set-Location` | Modifie le r√©pertoire courant (√©quivalent √† CD) |
| `New-LocalUser` | Cr√©e un nouvel utilisateur local sous Windows |
| `Get-EventLog` | Obtient un ou plusieurs √©v√©nements au journal de Windows |
| `Restart-Computer` | Red√©marre un ordinateur (local ou distant) |



### Anatomie d'une commande

En plus de son nom, la commande doit admettre certaines informations en entr√©e, afin de bien d√©crire l'action qui doit √™tre pos√©e. On peut ainsi lui sp√©cifier un certain nombre d'arguments.

![image](./assets/r01_06a.png)

Les arguments viennent s'ins√©rer dans les param√®tres qui sont admis par la commande. Chaque commande comporte son jeu de param√®tres, et chaque param√®tre a un nom, qu'on identifie en les pr√©fixant par un trait d'union. Il en existe plusieurs grands types:

- Les param√®tres qui admettent une valeur
- Les param√®tres qui admettent une ou plusieurs valeurs (s√©par√©es par des virgules)
- Les param√®tres bool√©ens, qu'on appelle switch, et qui activent une option lorsqu'on les sp√©cifie


### Aide en ligne

PowerShell est g√©n√©ralement tr√®s bien document√©. Vous pouvez avoir acc√®s √† la [documentation officielle](https://docs.microsoft.com/fr-ca/powershell/?view=powershell-5.1) sur le site de Microsoft.

:::tip Truc du prof
J'ai habituellement plus de facilit√© √† trouver ce que je cherche sur Google que sur le site de Microsoft. Il suffit de taper "_PowerShell Get-Quelquechose_" pour tomber pile sur la page en question. Assurez-vous toutefois de modifier la version de PowerShell pour celle que vous utilisez (par exemple, Windows PowerShell 5.1).
:::

#### Aide √† la ligne de commande

En plus du site de Microsoft, PowerShell permet la consultation des rubriques d'aide directement √† partir de la ligne de commande, √† l'instar de la commande man sous Linux/UNIX. Sous PowerShell, la commande √† utiliser est Get-Help.

![image](./assets/r01_07a.png)

On peut obtenir une d√©finition plus compl√®te avec le switch -Detailed, ou des exemples d'utilisation avec -Examples. On peut aussi obtenir toute l'information disponible avec le switch -Full.

![image](./assets/r01_07b.png)

Vous pouvez obtenir de l'information d√©taill√©e sur un param√®tre particulier avec le param√®tre -Parameter.

![image](./assets/r01_07c.png)


Il est possible d'afficher la rubrique d'aide dans une fen√™tre s√©par√©e avec le switch -ShowWindow.

![image](./assets/r01_07d.png)


Finalement, vous pouvez simplement demander √† ce que PowerShell ouvre la rubrique d'aide dans votre navigateur Web par d√©faut, √† l'aide du switch -Online.

![image](./assets/r01_07e.png)

#### Mise √† jour de l'aide

Pour pouvoir consulter les rubriques d'aide les plus r√©cente, il faut proc√©der √† la mise √† jour de ces derni√®res. On peut le faire √† l'aide de la commande Update-Help. Cette commande se connecte sur Internet pour obtenir la d√©finition la plus √† jour de la documentation pour chacun des modules install√©s sur le syst√®me. Notez que cette commande doit se faire avec des privil√®ge d'admin local.

![image](./assets/r01_07f.png)

Il se peut qu'il y ait quelques erreurs affich√©es en rouge. Cela arrive parfois, car pour certaines (rares) commandes, les rubriques d'aide n'existent pas encore. 

#### Param√®tres disponibles

Pour avoir la liste des param√®tres disponibles, vous pouvez consulter l'aide‚Ä¶ ou simplement √©crire le nom de la commande, puis le trait d'union et appuyer sur la touche de tabulation pour alterner entre chaque param√®tre disponible.

Vous pouvez aussi obtenir une liste de s√©lection des param√®tres. Pour cela, il suffit d'√©crire le nom de la commande, espace, trait d'union, et appuyer sur Ctrl+Espace pour afficher une liste dans la console. Naviguez dans la liste avec les fl√®ches sur le clavier pour √©crire le nom du param√®tre. Remarquez qu'en bas de la liste, le type du param√®tre est affich√©.

![image](./assets/r01_07g.png)


### Comprendre la documentation

Les d√©tails des param√®tres admis par une commande sont document√©s en ligne sur le site de Microsoft. 

La section Syntaxe indique le sommaire de tous les param√®tres utilisables.

![image](./assets/r01_08a.png)

Source: [Get-EventLog (Microsoft.PowerShell.Management) - PowerShell | Microsoft Docs](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-eventlog?view=powershell-5.1#syntax)


Plus loin dans l'article, on peut trouver la liste des param√®tres, en ordre alphab√©tique. On y sp√©cifie √† quoi sert le param√®tre, son type, sa position (dans le cas d'un param√®tre positionnel), sa valeur par d√©faut, si ce param√®tre peut √™tre fourni par le pipeline, et si des caract√®res de types wildcard (* et ?) peuvent √™tre sp√©cifi√©s.

![image](./assets/r01_08b.png)


### Param√®tres positionnels

Il est possible de sp√©cifier des param√®tres sans toujours identifier leur nom. C'est particuli√®rement pratique √† la ligne de commande, pour sauver du temps et des frappes de touches.

![image](./assets/r01_09a.png)

L'utilisation de param√®tres positionnels nuit toutefois √† la lisibilit√©, puisqu'il faut conna√Ætre par c≈ìur ce que signifie la premi√®re position, la seconde, etc. 

Par exemple, lorsqu'on utilise la commande Copy-Item avec deux param√®tres positionnels, le premier repr√©sente le chemin de la source et le second, le chemin de destination; bien que cet ordre soit intuitif et bien ancr√© dans nos r√©flexes, il faut n√©anmoins le conna√Ætre par c≈ìur. En sp√©cifiant les noms des param√®tres, non seulement la signification de chaque argument est explicite, mais en plus, ils peuvent √™tre dispos√©s dans n'importe quel ordre.

Par exemple, `Copy-Item -Path C:\Minou\miaou.txt -Destination C:\Pitou\wouf.txt` a le m√™me effet que `Copy-Item -Destination C:\Pitou\wouf.txt -Path C:\Minou\miaou.txt`

La signification des param√®tres positionnels varie selon le type des valeurs qu'on sp√©cifie, et sont document√©s en ligne sur le site Web de Microsoft. La position 0 d√©signe le premier argument, la position 1 d√©signe le deuxi√®me, et ainsi de suite.

![image](./assets/r01_09b.png)

Source: [Copy-Item (Microsoft.PowerShell.Management) - PowerShell | Microsoft Docs](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/copy-item?view=powershell-5.1#parameters)


Pour en savoir plus sur les param√®tres: [√† propos des param√®tres - PowerShell | Microsoft Docs](https://docs.microsoft.com/fr-ca/powershell/module/microsoft.powershell.core/about/about_parameters?view=powershell-5.1)


### Commandes disponibles

Il y a un grand nombre de commandes disponibles dans PowerShell. Non seulement il y a les commandes qui font partie int√©grante de la base de PowerShell, mais il est possible d'en enregistrer des nouvelles en installant des modules suppl√©mentaires.

Il existe plusieurs mani√®res d'obtenir la liste des commande disponibles.

#### `Get-Command`

La commande `Get-Command` retourne un objet qui √©num√®re toutes les commandes disponibles dans la session PowerShell.

Attention, y'en a beaucoup!

![image](./assets/r01_10a.png)

On peut savoir combien il y en a avec la commande Measure-Object. Cette commande sert √† effectuer une analyse d'un objet, comme pour compter ses √©l√©ments (lorsqu'il s'agit d'une collection d'objets).

![image](./assets/r01_10b.png)

On peut rechercher toutes les commandes qui concernent un type d'objet en particulier, √† l'aide du param√®tre -Noun.

![image](./assets/r01_10c.png)

Ou encore, toutes les commandes qui font partie d'un module pr√©cis (dans cet exemple, le module Defender qui permet de contr√¥ler l'anti-virus Microsoft Defender)

![image](./assets/r01_10d.png)


#### `Show-Command`

La commande `Show-Command` affiche √† l'√©cran une interface graphique (GUI) pour vous aider √† trouver une commande et √† la construire avec tous ses param√®tres.

![image](./assets/r01_10e.png)


### Alias

La forme `Verbe-Nom` des commandes a l'avantage d'√™tre explicite et claire, mais a aussi l'inconv√©nient d'√™tre encombrante dans la ligne de commande. Pour pallier ce probl√®me, PowerShell permet de substituer des alias aux commandes. Ces alias peuvent faire gagner du temps, par le nombre r√©duit de caract√®res √† taper mais aussi en pr√©servant nos r√©flexes provenant de la ligne de commande Windows ou Linux.

Par exemple, `Get-ChildItem` dispose de trois alias par d√©faut: `dir`, `ls` et `gci`. Utiliser ces trois commandes a le m√™me effet que d'utiliser `Get-ChildItem`; on peut voir √ßa comme un raccourci.

![image](./assets/r01_11a.png)


C'est bien pratique dans la ligne de commande, mais il est tout de m√™me pr√©f√©rable d'utiliser le vrai nom de la commande dans un script, car cela aide √† la compr√©hension du script.

Pour voir la liste des alias, il suffit de lancer la commande `Get-Alias`.

![image](./assets/r01_11b.png)


Pour cr√©er un nouvel alias, la commande √† utiliser est `New-Alias`. 

![image](./assets/r01_11c.png)


Il faut faire attention cependant, car cet alias sera d√©truit lorsque votre session PowerShell se terminera (soit en fermant la console, soit √† la fin d'un script). Pour qu'un alias soit permanent, il faut le d√©finir dans un profil. Vous pouvez lire cet article pour en apprendre plus au sujet des profils PowerShell: [√† propos des profils - PowerShell | Microsoft Docs](https://docs.microsoft.com/fr-ca/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-5.1)


## Commandes utiles

Voici quelques exemples de commandes fr√©quemment utilis√©es par les administrateurs de syst√®me. Ce n'est qu'un aper√ßu, car il en existe des centaines. Par ailleurs, vous verrez dans les prochains cours des techniques qui vous permettront de maximiser leur utilisation.


### Syst√®me de fichiers

`Get-Item` : Obtient de l'information sur un √©l√©ment du syst√®me de fichiers.

`Get-ChildItem` : Obtient de l'information sur le contenu du r√©pertoire courant.

`Get-ChildItem -Path "C:\Windows"` : Obtient la liste des √©l√©ments contenus dans le r√©pertoire _C:\Windows_.

`Get-ChildItem -Recurse` : Obtient la liste des √©l√©ments contenus dans le r√©pertoire courant et tous ses sous-r√©pertoires.

`Get-ChildItem -Path "C:\Windows\w*.exe"` : Obtient la liste des √©l√©ments dans _C:\Windows_ qui commencent par "_w_" et se terminent par "_.exe_". Le param√®tre `-Path` est implicite.

`Get-ChildItem -Directory` : Obtient la liste des *r√©pertoires* contenus dans le r√©pertoire courant.

`Get-ChildItem -File` : Obtient la liste des *fichiers* contenus dans le r√©pertoire courant.

`New-Item "Minou.txt"` : Cr√©e un nouveau fichier vide nomm√© _Minou.txt_ dans le r√©pertoire courant. Le param√®tre `-Path` est implicite.

`New-Item -Path "Minou" -ItemType Directory` : Cr√©e un nouveau dossier nomm√© _Minou_ dans le r√©pertoire courant.

`New-Item "C:\Temp\Minou.txt"` : Cr√©e un nouveau fichier vide nomm√© Minou.txt dans le r√©pertoire _C:\Temp_. Le param√®tre `-Path` est implicite.

`Remove-Item "C:\Temp\Minou.txt"` : Supprime le fichier _C:\Temp\Minou.txt_. Le param√®tre `-Path` est implicite.

`Copy-Item "C:\Temp\Minou.txt" "C:\Temp2\Minou2.txt` : Copie le fichier _C:\Temp\Minou.txt_ vers _C:\Temp2\Minou2.txt_. Les param√®tres `-Path` et `-Destination` sont implicites.

`Move-Item "C:\Temp\Minou.txt" "C:\Temp2\Minou2.txt` : D√©place le fichier _C:\Temp\Minou.txt_ vers _C:\Temp2\Minou2.txt_. Les param√®tres `-Path` et `-Destination` sont implicites.

`Set-Location "C:\Windows"` : Modifie le r√©pertoire de travail vers _C:\Windows_. Le param√®tre `-Path` est implicite.

`Push-Location "C:\Windows"` : Modifie le r√©pertoire de travail vers _C:\Windows_ en gardant en m√©moire l'emplacement courant. Le param√®tre `-Path` est implicite.

`Pop-Location` : R√©tablit le r√©pertoire de travail pr√©c√©dent (celui d'avant le dernier appel de `Push-Location`)

`Get-Content "C:\Windows\System32\drivers\etc\HOSTS"` : Affiche le contenu du fichier HOSTS dans la console.


### Gestion des services

Les services sont des logiciels g√©r√©s par Windows qui sont ex√©cut√©s en arri√®re-plan et b√©nificient d'acc√®s privil√©gi√©s sur le syst√®me. Par l'interface graphique, on peut administrer les services √† travers la console MMC du gestionnaire de services (services.msc, compmgmt.msc, etc.) ou par le gestionnaire des t√¢ches (taskmgr.exe). Par la ligne de commande classique, ils peuvent √™tre contr√¥l√©s par les commandes NET (contr√¥le de base) ou SC (contr√¥le avanc√©). Voici des exemples de commandes PowerShell pour les manipuler:

`Get-Service` : Obtient la liste des services install√©s sur le syst√®me.

`Get-Service -Name "spooler"` : Obtient l'information sur le service "spooler". Le nom du param√®tre `-Name` peut √™tre omis.

`Get-Service "s*"` : Obtient la liste des services dont le nom commence par "_s_". Le param√®tre `-Name` est implicite.

`Start-Service -Name "spooler"` : D√©marre le service "spooler".

`Stop-Service "spooler"` : Arr√™te le service "spooler". Le param√®tre `-Name` est implicite.

`Restart-Service -Name "spooler"` : Arr√™te puis d√©marre le service "spooler" en une seule op√©ration.

`Set-Service -Name "spooler" -StartupType Disabled` : D√©sactive le service "spooler" (il ne pourra plus d√©marrer).


### Gestion des processus

Les processus sont des objets logiques servant √† attribuer des ressources syst√®me √† un programme (m√©moire, temps de processeur, contexte de s√©curit√©, etc.) afin qu'il puisse s'ex√©cuter. Chaque fois qu'un fichier ex√©cutable est lanc√©, un processus est cr√©√© √† son image. Chaque processus dispose d'un identifiant num√©rique, le PID. Lorsque le programme a termin√© son ex√©cution, le processus "meurt" et est d√©truit, ce qui lib√®re les ressources qui lui √©taient r√©serv√©es. Il est possible d'obtenir de l'information sur les processus en cours d'ex√©cution ou les terminer de force par l'interface graphique √† travers le gestionnaire des t√¢ches (taskmgr.exe), ou par la ligne de commande classique au moyen des utilitaires TASKLIST et TASKKILL. Voici des examples de commandes PowerShell permettant de manipuler les processus:

`Get-Process` : Obtient la liste des processus en cours d'ex√©cution sur le syst√®me.

`Get-Process 123` : Obtient de l'information sur le processus dont le PID est 123.

`Get-Process -Name "notepad"` : Obtient la liste des processus en cours d'ex√©cution sur le syst√®me dont l'image est "notepad". On ne peut pas omettre le nom du param√®tre `-Name`, car le param√®tre positionnel √† la position 0 est `-Id`.

`Start-Process "notepad.exe"` : D√©marre une instance de notepad.exe. Le param√®tre `-FilePath` est implicite.

`Start-Process -FilePath "notepad.exe" -ArgumentList "C:\Windows\System32\Drivers\etc\hosts" -Verb RunAs` : Ouvre le fichier HOSTS dans Notepad avec des privil√®ges administrateur.

`Stop-Process -Id 123` : Termine (tue) le processus num√©ro 123. Cette commande √©choue s'il n'y a pas de processus √† ce num√©ro. Le param√®tre `-Id` peut √™tre omis.

`Stop-Process -Name "notepad"` : Termine tous les processus qui s'appellent notepad.


### Gestion du stockage

`Get-Volume` : Obtient de l'information sur les volumes de stockage (disque dur, cl√© USB, etc.) accessibles √† Windows.

`Get-Partition` : Obtient de l'information sur les partitions des disques durs et m√©diums physiques de stockage install√©s sur le syst√®me.

`Get-Disk` : Obtient de l'information sur les p√©riph√©riques de stockage mat√©riels install√©s sur le syst√®me.


### Gestion des utilisateurs et groupes locaux

`Get-LocalUser` : Obtient la liste des utilisateurs locaux du syst√®me.

`Get-LocalGroup` : Obtient la liste des groupes locaux du syst√®me.

`Get-LocalGroupMember -Group Administrateurs` : Obtient la liste des membres du groupe local Administrateurs.

`Get-LocalGroupMember -SID "S-1-5-32-544"` : Obtient la liste des membres du groupe local Administrateurs peu importe la langue du syst√®me.


### Configuration r√©seau

`Get-NetAdapter` : Obtient la liste des adapteurs r√©seau install√©s (physiques ou virtuels).

`Get-NetAdapter -Physical` : Obtient la liste des adapteurs r√©seau install√©s (physiques seulement).

`Get-NetAdapterHardwareInfo` : Obtient la liste des adapteurs r√©seau mat√©rielles et des informations sur leur connexion physique √† l'ordinateur.

`Get-NetIPInterface` : Obtient la liste des interfaces r√©seau

`Get-NetIPAddress` : Obtient la liste des adresses IP

`Get-NetIPAddress -AddressFamily IPv4` : Obtient la liste des adresses IPv4

`Get-NetIPInterface` : Obtient la liste des interfaces r√©seau

`New-NetIPAddress ‚ÄìIPAddress 192.168.1.10 -DefaultGateway 192.168.1.1 -PrefixLength 24 -InterfaceIndex 5` : D√©finit la configuration IP sur l'interface r√©seau 5.

`Set-DNSClientServerAddress ‚ÄìInterfaceIndex 5 ‚ÄìServerAddresses 192.168.1.10` : D√©finit 192.168.1.10 comme r√©solveur DNS sur l'interface r√©seau 5.


### Autres commandes

`Clear-Host` : Efface l'affichage dans le programme h√¥te.

`Get-EventLog -LogName Application -Newest 20` : Obtient la liste des 20 derniers √©v√©nements du journal Application (dans l'observateur d'√©v√©nements)

`Get-Date` : Obtient la date et l'heure dans le format localis√© du syst√®me

`Get-Date -Format "yyyy-MM-dd"` : Obtient la date en format ISO 8601. Vous pouvez consulter [l'article concernant les formats de date](https://learn.microsoft.com/fr-ca/dotnet/standard/base-types/custom-date-and-time-format-strings?view=netframework-4.8) du framework .NET sur le site de Microsoft.

`Get-Date -UFormat "%Y-%m-%d"` : Obtient la date en format ISO 8601. Le r√©sultat est le m√™me que dans l'exemple pr√©c√©dent, mais utilise la notation UNIX au lieu de la notation .NET. Vous pouvez [consulter la documentation](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-date?view=powershell-5.1#notes) pour en savoir plus.

`Invoke-Item -Path C:\Temp\MonDocument.docx` : Ouvre le fichier sp√©cifi√© dans le logiciel par d√©faut traitant ce type de fichier (dans ce cas, Microsoft Word).

`Test-NetConnection -ComputerName "10.10.7.110" -Port 3000` : Teste la connectivit√© au port 3000/tcp sur la machine 10.10.7.110.

`Restart-Computer` : Red√©marre l'ordinateur

`Rename-Computer -NewName "MIAOUMIAOU" -Restart` : Renomme l'ordinateur et red√©marre automatiquement

`Install-WindowsFeature -Name "AD-Domain-Services" -IncludeManagementTools` : Installe le r√¥le Active Directory Domain Services sur Windows Server avec ses outils de gestion.

`Install-ADDSForest -DomainName "ad.minou.net" -DomainNetBIOSName "MINOU" -InstallDNS` : Effectue la promotion du serveur comme premier contr√¥leur de domaine de sa for√™t et installe automatiquement le serveur DNS.

`Add-Computer -DomainName "ad.minou.net" -Restart` : Effectue la jonction du syst√®me au domaine ad.minou.net et red√©marre automatiquement.

`Add-Computer -DomainName "ad.minou.net" -OUPath "OU=Postes de travail,DC=ad,DC=minou,DC=net"` : Effectue la jonction du syst√®me au domaine ad.minou.net et cr√©e le compte utilisateur dans l'OU _Postes de travail_ plut√¥t que dans le conteneur _computer_ par d√©faut.

`Install-Module -Name "AdsiPS"` : Installe le module AdsiPS √† partir du d√©p√¥t PowerShell Gallery.

`Get-Command -Module AdsiPS` : Liste toutes les commandes offertes par le module AdsiPS
